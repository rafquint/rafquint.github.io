<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo AlaSQL com Northwind Database - Enhanced</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Bootstrap 5 JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- Vue.js 3 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.min.js"></script>
    <!-- AlaSQL -->
    <script src="https://cdn.jsdelivr.net/npm/alasql@1.7/dist/alasql.min.js"></script>
	
    <style>
        .query-card {
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .query-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .result-table {
            max-height: 400px;
            overflow-y: auto;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        .sql-code {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            font-size: 0.9rem;
            border-radius: 8px;
            position: relative;
            overflow-x: auto;
        }
        .sql-code::before {
            content: 'SQL';
            position: absolute;
            top: 5px;
            right: 10px;
            background: #007bff;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .navbar-brand {
            font-weight: bold;
        }
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 0;
            position: relative;
            overflow: hidden;
        }
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }
        .hero-section .container {
            position: relative;
            z-index: 1;
        }
        .card-header {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            border: none;
            font-weight: 600;
        }
        .stats-card {
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 15px;
            overflow: hidden;
        }
        .stats-card:hover {
            transform: scale(1.08) rotate(1deg);
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        }
        .custom-query-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 15px;
            border: none;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
        }
        .btn-execute {
            background: linear-gradient(45deg, #28a745, #20c997);
            border: none;
            padding: 10px 25px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }
        .btn-execute:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        .error-alert {
            border-left: 4px solid #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }
        .success-alert {
            border-left: 4px solid #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .query-history {
            max-height: 200px;
            overflow-y: auto;
        }
        .history-item {
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 5px;
            padding: 8px;
            margin: 2px 0;
        }
        .history-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-lg">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <i class="bi bi-database-fill me-2"></i> AlaSQL + Northwind Demo
                </a>
                <div class="d-flex align-items-center">
                    <span class="badge bg-success me-2" v-if="!loading">
                        <i class="bi bi-check-circle me-1"></i>Database Ready
                    </span>
                    <span class="badge bg-warning" v-else>
                        <div class="loading-spinner me-1"></div>Loading...
                    </span>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <div class="hero-section text-center">
            <div class="container">
                <h1 class="display-4 mb-3 fw-bold">Demo AlaSQL com Northwind Database</h1>
                <p class="lead mb-4">Explore consultas SQL em JavaScript usando AlaSQL com dados do clássico banco Northwind</p>
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="alert alert-light bg-opacity-90" role="alert">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>Experimente:</strong> Execute consultas SQL diretamente no navegador, 
                            modifique dados e veja os resultados em tempo real!
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container mt-5">
            <!-- Estatísticas -->
            <div class="text-end mb-4">
                <button @click="updateStatistics" class="btn btn-outline-primary btn-sm" :disabled="loading">
                    <i class="bi bi-arrow-clockwise me-1"></i> Atualizar Contadores
                </button>
            </div>
            
            <div class="row mb-5 fade-in">
                <div class="col-md-3 mb-3">
                    <div class="card text-center bg-primary text-white stats-card" :class="{ 'pulse-animation': statisticsUpdated }">
                        <div class="card-body">
                            <i class="bi bi-people-fill fs-1 mb-2"></i>
                            <h3 class="fw-bold">{{ customersCount }}</h3>
                            <p class="mb-0">Clientes</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center bg-success text-white stats-card" :class="{ 'pulse-animation': statisticsUpdated }">
                        <div class="card-body">
                            <i class="bi bi-box-seam fs-1 mb-2"></i>
                            <h3 class="fw-bold">{{ productsCount }}</h3>
                            <p class="mb-0">Produtos</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center bg-warning text-white stats-card" :class="{ 'pulse-animation': statisticsUpdated }">
                        <div class="card-body">
                            <i class="bi bi-receipt fs-1 mb-2"></i>
                            <h3 class="fw-bold">{{ ordersCount }}</h3>
                            <p class="mb-0">Pedidos</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center bg-info text-white stats-card" :class="{ 'pulse-animation': statisticsUpdated }">
                        <div class="card-body">
                            <i class="bi bi-tags fs-1 mb-2"></i>
                            <h3 class="fw-bold">{{ categoriesCount }}</h3>
                            <p class="mb-0">Categorias</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Status de Carregamento -->
            <div v-if="loading" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-info text-center">
                        <div class="loading-spinner me-2"></div>
                        Carregando dados do banco...
                    </div>
                </div>
            </div>

            <!-- Consultas Personalizadas -->
            <div class="row mb-5">
                <div class="col-12">
                    <div class="card custom-query-section">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="bi bi-tools me-2"></i>Consulta Personalizada
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-8">
                                    <div class="mb-3">
                                        <label class="form-label fw-bold">Digite sua consulta SQL:</label>
                                        <textarea 
                                            v-model="customQuery" 
                                            class="form-control form-control-lg" 
                                            rows="4" 
                                            placeholder="Ex: SELECT * FROM customers LIMIT 5"
                                            style="font-family: 'JetBrains Mono', 'Courier New', monospace;">
                                        </textarea>
                                    </div>
                                    <div class="mb-3">
                                        <button @click="executeCustomQuery" class="btn btn-execute me-3" :disabled="loading || !customQuery.trim()">
                                            <i class="bi bi-play-fill me-1"></i>Executar Consulta
                                        </button>
                                        <div class="btn-group" role="group">
                                            <button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                                <i class="bi bi-collection me-1"></i>Exemplos
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><h6 class="dropdown-header">Consultas SELECT</h6></li>
                                                <li><a class="dropdown-item" href="#" @click="setExampleQuery('SELECT * FROM customers')">
                                                    <i class="bi bi-people me-2"></i>Listar todos os clientes</a></li>
                                                <li><a class="dropdown-item" href="#" @click="setExampleQuery('SELECT p.ProductName, c.CategoryName, p.UnitPrice FROM products p JOIN categories c ON p.CategoryID = c.CategoryID ORDER BY p.UnitPrice DESC LIMIT 10')">
                                                    <i class="bi bi-box me-2"></i>Produtos mais caros com categoria</a></li>
                                                <li><hr class="dropdown-divider"></li>
                                                <li><h6 class="dropdown-header">Modificação de Dados</h6></li>
                                                <li><a class="dropdown-item" href="#" @click="setExampleQuery('INSERT INTO customers VALUES (\'TEST1\', \'Empresa Teste\', \'João Silva\', \'São Paulo\', \'Brasil\')')">
                                                    <i class="bi bi-plus-circle me-2"></i>Inserir novo cliente</a></li>
                                                <li><a class="dropdown-item" href="#" @click="setExampleQuery('DELETE FROM customers WHERE CustomerID = \'TEST1\'')">
                                                    <i class="bi bi-trash me-2"></i>Deletar cliente teste</a></li>
                                                <li><a class="dropdown-item" href="#" @click="setExampleQuery('UPDATE products SET UnitPrice = UnitPrice * 1.1 WHERE CategoryID = 1')">
                                                    <i class="bi bi-pencil me-2"></i>Aumentar preços de bebidas em 10%</a></li>
                                                <li><a class="dropdown-item" href="#" @click="setExampleQuery('INSERT INTO products VALUES (99, \'Produto Novo\', 1, 25.50)')">
                                                    <i class="bi bi-box-arrow-in-right me-2"></i>Inserir novo produto</a></li>
                                            </ul>
                                        </div>
                                        <button @click="clearQuery" class="btn btn-outline-danger ms-2">
                                            <i class="bi bi-x-circle me-1"></i>Limpar
                                        </button>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="card bg-light h-100">
                                        <div class="card-header bg-secondary text-white">
                                            <h6 class="mb-0">
                                                <i class="bi bi-clock-history me-2"></i>Histórico
                                            </h6>
                                        </div>
                                        <div class="card-body query-history">
                                            <div v-if="queryHistory.length === 0" class="text-muted text-center">
                                                <i class="bi bi-inbox"></i>
                                                <p class="mb-0 mt-2">Nenhuma consulta executada ainda</p>
                                            </div>
                                            <div v-else>
                                                <div v-for="(query, index) in queryHistory.slice().reverse()" :key="index" 
                                                     class="history-item" @click="setExampleQuery(query)">
                                                    <small class="text-muted d-block">{{ query.substring(0, 50) }}{{ query.length > 50 ? '...' : '' }}</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="alert alert-info border-0 mt-3">
                                <i class="bi bi-lightbulb me-2"></i>
                                <strong>💡 Dica:</strong> Experimente comandos INSERT, UPDATE ou DELETE para ver os contadores atualizarem dinamicamente!
                            </div>
                            
                            <div v-if="customError" class="alert error-alert mt-3">
                                <i class="bi bi-exclamation-triangle me-2"></i>
                                {{ customError }}
                            </div>
                            
                            <div v-if="queryExecutionTime" class="alert success-alert mt-3">
                                <i class="bi bi-stopwatch me-2"></i>
                                Consulta executada em {{ queryExecutionTime }}ms
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resultados da Consulta Personalizada -->
            <div v-if="customResult.length > 0" class="row mb-5 fade-in">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="bi bi-table me-2"></i>
                                Resultado da Consulta Personalizada 
                                <span class="badge bg-light text-dark ms-2">{{ customResult.length }} registros</span>
                            </h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive result-table">
                                <table class="table table-striped table-hover mb-0">
                                    <thead class="table-dark sticky-top">
                                        <tr>
                                            <th v-for="column in Object.keys(customResult[0])" :key="column" class="fw-bold">
                                                <i class="bi bi-sort-alpha-down me-1"></i>{{ column }}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(row, index) in customResult" :key="index" class="table-row">
                                            <td v-for="column in Object.keys(customResult[0])" :key="column">
                                                {{ formatValue(row[column]) }}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Consultas Predefinidas -->
            <div class="row">
                <div class="col-12 mb-4">
                    <h3 class="text-center fw-bold">
                        <i class="bi bi-collection me-2"></i>Consultas Predefinidas
                    </h3>
                    <p class="text-center text-muted">Explore exemplos práticos de consultas SQL com o banco Northwind</p>
                </div>
                <div class="col-lg-6 mb-4" v-for="(query, index) in predefinedQueries" :key="index">
                    <div class="card query-card h-100">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i :class="query.icon + ' me-2'"></i>{{ query.title }}
                            </h6>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">{{ query.description }}</p>
                            <div class="sql-code">
                                <code>{{ query.sql }}</code>
                            </div>
                            <button @click="executeQuery(index)" class="btn btn-outline-primary btn-sm me-2" :disabled="loading">
                                <i class="bi bi-play-fill me-1"></i>Executar
                            </button>
                            <button @click="copyToCustomQuery(query.sql)" class="btn btn-outline-secondary btn-sm">
                                <i class="bi bi-clipboard me-1"></i>Copiar
                            </button>
                            
                            <!-- Resultado -->
                            <div v-if="query.result && query.result.length > 0" class="mt-4 fade-in">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <h6 class="text-muted mb-0">
                                        <i class="bi bi-table me-1"></i>Resultado:
                                    </h6>
                                    <span class="badge bg-primary">{{ query.result.length }} registros</span>
                                </div>
                                <div class="table-responsive result-table">
                                    <table class="table table-sm table-striped">
                                        <thead class="table-light">
                                            <tr>
                                                <th v-for="column in Object.keys(query.result[0])" :key="column" class="small fw-bold">
                                                    {{ column }}
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="row in query.result.slice(0, 5)" :key="row">
                                                <td v-for="column in Object.keys(query.result[0])" :key="column" class="small">
                                                    {{ formatValue(row[column]) }}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div v-if="query.result.length > 5" class="text-center p-2 bg-light">
                                        <small class="text-muted">
                                            <i class="bi bi-three-dots me-1"></i>
                                            Mostrando 5 de {{ query.result.length }} resultados
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-dark text-light py-5 mt-5">
            <div class="container">
                <div class="row">
                    <div class="col-md-8">
                        <h5><i class="bi bi-database-fill me-2"></i>AlaSQL + Northwind Demo</h5>
                        <p class="mb-0">Aplicação de demonstração criada para explorar as capacidades do AlaSQL com dados do clássico banco Northwind.</p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <p class="mb-1">Tecnologias utilizadas:</p>
                        <div class="d-flex justify-content-md-end gap-3">
                            <span class="badge bg-primary">Vue.js 3</span>
                            <span class="badge bg-success">Bootstrap 5</span>
                            <span class="badge bg-warning">AlaSQL</span>
                        </div>
                    </div>
                </div>
                <hr class="my-4">
                <div class="text-center">
                    <p>&copy; 2024 Demo AlaSQL + Northwind. Desenvolvido com ❤️</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    loading: true,
                    customersCount: 0,
                    productsCount: 0,
                    ordersCount: 0,
                    categoriesCount: 0,
                    statisticsUpdated: false,
                    customQuery: 'SELECT * FROM customers LIMIT 5',
                    customResult: [],
                    customError: '',
                    queryExecutionTime: null,
                    queryHistory: [],
                    predefinedQueries: [
                        {
                            title: 'Top 5 Clientes',
                            description: 'Lista os primeiros 5 clientes ordenados por nome da empresa',
                            sql: 'SELECT CustomerID, CompanyName, City, Country FROM customers ORDER BY CompanyName LIMIT 5',
                            result: [],
                            icon: 'bi bi-people-fill'
                        },
                        {
                            title: 'Produtos por Categoria',
                            description: 'Mostra quantos produtos existem em cada categoria com JOIN',
                            sql: 'SELECT c.CategoryName, COUNT(p.ProductID) as ProductCount FROM categories c LEFT JOIN products p ON c.CategoryID = p.CategoryID GROUP BY c.CategoryID, c.CategoryName ORDER BY ProductCount DESC',
                            result: [],
                            icon: 'bi bi-box-seam'
                        },
                        {
                            title: 'Pedidos por País',
                            description: 'Agrupa pedidos por país de destino e conta o total',
                            sql: 'SELECT ShipCountry, COUNT(OrderID) as OrderCount FROM orders GROUP BY ShipCountry ORDER BY OrderCount DESC',
                            result: [],
                            icon: 'bi bi-geo-alt-fill'
                        },
                        {
                            title: 'Produtos Mais Caros',
                            description: 'Lista os 5 produtos com maior preço unitário',
                            sql: 'SELECT ProductName, UnitPrice, CategoryID FROM products ORDER BY UnitPrice DESC LIMIT 5',
                            result: [],
                            icon: 'bi bi-currency-dollar'
                        },
                        {
                            title: 'Clientes e Pedidos',
                            description: 'Relaciona clientes com seus pedidos usando INNER JOIN',
                            sql: 'SELECT c.CompanyName, o.OrderID, o.OrderDate FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID ORDER BY o.OrderDate DESC LIMIT 10',
                            result: [],
                            icon: 'bi bi-link-45deg'
                        },
                        {
                            title: 'Estatísticas Avançadas',
                            description: 'Calcula estatísticas gerais do banco usando sub-consultas',
                            sql: 'SELECT "Total de Clientes" as Metrica, (SELECT COUNT(1) FROM customers) as Valor UNION ALL SELECT "Total de Produtos", (SELECT COUNT(1) FROM products) UNION ALL SELECT "Total de Pedidos", (SELECT COUNT(1) FROM orders) UNION ALL SELECT "Preço Médio dos Produtos", ROUND((SELECT AVG(UnitPrice) FROM products), 2)',
                            result: [],
                            icon: 'bi bi-graph-up'
                        }
                    ]
                }
            },
            async mounted() {
                await this.initializeDatabase();
				console.log("Versão AlaSQL:", alasql.version);
            },
            methods: {
                async initializeDatabase() {
                    this.loading = true;
                    
                    try {
                        // Limpar banco se já existir
                        try {
                            alasql('DROP TABLE IF EXISTS customers');
                            alasql('DROP TABLE IF EXISTS categories');
                            alasql('DROP TABLE IF EXISTS products');
                            alasql('DROP TABLE IF EXISTS orders');
                        } catch (e) {
                            // Ignorar erros de drop
                        }

                        // Criar tabelas com constraints melhoradas
                        alasql('CREATE TABLE customers (CustomerID STRING PRIMARY KEY, CompanyName STRING, ContactName STRING, City STRING, Country STRING)');
                        alasql('CREATE TABLE categories (CategoryID INT PRIMARY KEY, CategoryName STRING, Description STRING)');
                        alasql('CREATE TABLE products (ProductID INT PRIMARY KEY, ProductName STRING, CategoryID INT, UnitPrice MONEY)');
                        alasql('CREATE TABLE orders (OrderID INT PRIMARY KEY, CustomerID STRING, OrderDate DATE, ShipCountry STRING)');

                        // Dados expandidos - Customers
                        const customersData = [
                            {CustomerID: 'ALFKI', CompanyName: 'Alfreds Futterkiste', ContactName: 'Maria Anders', City: 'Berlin', Country: 'Germany'},
                            {CustomerID: 'ANATR', CompanyName: 'Ana Trujillo Emparedados y Helados', ContactName: 'Ana Trujillo', City: 'México D.F.', Country: 'Mexico'},
                            {CustomerID: 'ANTON', CompanyName: 'Antonio Moreno Taquería', ContactName: 'Antonio Moreno', City: 'México D.F.', Country: 'Mexico'},
                            {CustomerID: 'AROUT', CompanyName: 'Around the Horn', ContactName: 'Thomas Hardy', City: 'London', Country: 'UK'},
                            {CustomerID: 'BERGS', CompanyName: 'Berglunds snabbköp', ContactName: 'Christina Berglund', City: 'Luleå', Country: 'Sweden'},
                            {CustomerID: 'BLAUS', CompanyName: 'Blauer See Delikatessen', ContactName: 'Hanna Moos', City: 'Mannheim', Country: 'Germany'},
                            {CustomerID: 'BLONP', CompanyName: 'Blondel père et fils', ContactName: 'Frédérique Citeaux', City: 'Strasbourg', Country: 'France'},
                            {CustomerID: 'BOLID', CompanyName: 'Bólido Comidas preparadas', ContactName: 'Martín Sommer', City: 'Madrid', Country: 'Spain'},
                            {CustomerID: 'BONAP', CompanyName: 'Bon app\'', ContactName: 'Laurence Lebihan', City: 'Marseille', Country: 'France'},
                            {CustomerID: 'BOTTM', CompanyName: 'Bottom-Dollar Markets', ContactName: 'Elizabeth Lincoln', City: 'Tsawassen', Country: 'Canada'},
                            {CustomerID: 'BSBEV', CompanyName: 'B\'s Beverages', ContactName: 'Victoria Ashworth', City: 'London', Country: 'UK'},
                            {CustomerID: 'CACTU', CompanyName: 'Cactus Comidas para llevar', ContactName: 'Patricio Simpson', City: 'Buenos Aires', Country: 'Argentina'},
                            {CustomerID: 'CENTC', CompanyName: 'Centro comercial Moctezuma', ContactName: 'Francisco Chang', City: 'México D.F.', Country: 'Mexico'},
                            {CustomerID: 'CHOPS', CompanyName: 'Chop-suey Chinese', ContactName: 'Yang Wang', City: 'Bern', Country: 'Switzerland'}
                        ];

                        // Dados expandidos - Categories
                        const categoriesData = [
                            {CategoryID: 1, CategoryName: 'Beverages', Description: 'Soft drinks, coffees, teas, beers, and ales'},
                            {CategoryID: 2, CategoryName: 'Condiments', Description: 'Sweet and savory sauces, relishes, spreads, and seasonings'},
                            {CategoryID: 3, CategoryName: 'Dairy Products', Description: 'Cheeses'},
                            {CategoryID: 4, CategoryName: 'Grains/Cereals', Description: 'Breads, crackers, pasta, and cereal'},
                            {CategoryID: 5, CategoryName: 'Meat/Poultry', Description: 'Prepared meats'},
                            {CategoryID: 6, CategoryName: 'Produce', Description: 'Dried fruit and bean curd'},
                            {CategoryID: 7, CategoryName: 'Seafood', Description: 'Seaweed and fish'},
                            {CategoryID: 8, CategoryName: 'Confections', Description: 'Desserts, candies, and sweet breads'}
                        ];

                        // Dados expandidos - Products
                        const productsData = [
                            {ProductID: 1, ProductName: 'Chai', CategoryID: 1, UnitPrice: 18.00},
                            {ProductID: 2, ProductName: 'Chang', CategoryID: 1, UnitPrice: 19.00},
                            {ProductID: 3, ProductName: 'Aniseed Syrup', CategoryID: 2, UnitPrice: 10.00},
                            {ProductID: 4, ProductName: 'Chef Anton\'s Cajun Seasoning', CategoryID: 2, UnitPrice: 22.00},
                            {ProductID: 5, ProductName: 'Chef Anton\'s Gumbo Mix', CategoryID: 2, UnitPrice: 21.35},
                            {ProductID: 6, ProductName: 'Grandma\'s Boysenberry Spread', CategoryID: 2, UnitPrice: 25.00},
                            {ProductID: 7, ProductName: 'Uncle Bob\'s Organic Dried Pears', CategoryID: 6, UnitPrice: 30.00},
                            {ProductID: 8, ProductName: 'Northwoods Cranberry Sauce', CategoryID: 2, UnitPrice: 40.00},
                            {ProductID: 9, ProductName: 'Mishi Kobe Niku', CategoryID: 5, UnitPrice: 97.00},
                            {ProductID: 10, ProductName: 'Ikura', CategoryID: 7, UnitPrice: 31.00},
                            {ProductID: 11, ProductName: 'Queso Cabrales', CategoryID: 3, UnitPrice: 21.00},
                            {ProductID: 12, ProductName: 'Queso Manchego La Pastora', CategoryID: 3, UnitPrice: 38.00},
                            {ProductID: 13, ProductName: 'Konbu', CategoryID: 7, UnitPrice: 6.00},
                            {ProductID: 14, ProductName: 'Tofu', CategoryID: 6, UnitPrice: 23.25},
                            {ProductID: 15, ProductName: 'Genen Shouyu', CategoryID: 2, UnitPrice: 15.50},
                            {ProductID: 16, ProductName: 'Pavlova', CategoryID: 8, UnitPrice: 17.45},
                            {ProductID: 17, ProductName: 'Alice Mutton', CategoryID: 5, UnitPrice: 39.00},
                            {ProductID: 18, ProductName: 'Carnarvon Tigers', CategoryID: 7, UnitPrice: 62.50},
                            {ProductID: 19, ProductName: 'Teatime Chocolate Biscuits', CategoryID: 8, UnitPrice: 9.20},
                            {ProductID: 20, ProductName: 'Sir Rodney\'s Marmalade', CategoryID: 8, UnitPrice: 81.00}
                        ];

                        // Dados expandidos - Orders
                        const ordersData = [
                            {OrderID: 10248, CustomerID: 'ALFKI', OrderDate: '1996-07-04', ShipCountry: 'Germany'},
                            {OrderID: 10249, CustomerID: 'ANATR', OrderDate: '1996-07-05', ShipCountry: 'Mexico'},
                            {OrderID: 10250, CustomerID: 'ANTON', OrderDate: '1996-07-08', ShipCountry: 'Mexico'},
                            {OrderID: 10251, CustomerID: 'AROUT', OrderDate: '1996-07-08', ShipCountry: 'UK'},
                            {OrderID: 10252, CustomerID: 'BERGS', OrderDate: '1996-07-09', ShipCountry: 'Sweden'},
                            {OrderID: 10253, CustomerID: 'BLAUS', OrderDate: '1996-07-10', ShipCountry: 'Germany'},
                            {OrderID: 10254, CustomerID: 'BLONP', OrderDate: '1996-07-11', ShipCountry: 'France'},
                            {OrderID: 10255, CustomerID: 'BOLID', OrderDate: '1996-07-12', ShipCountry: 'Spain'},
                            {OrderID: 10256, CustomerID: 'BONAP', OrderDate: '1996-07-15', ShipCountry: 'France'},
                            {OrderID: 10257, CustomerID: 'BOTTM', OrderDate: '1996-07-16', ShipCountry: 'Canada'},
                            {OrderID: 10258, CustomerID: 'ALFKI', OrderDate: '1996-07-17', ShipCountry: 'Germany'},
                            {OrderID: 10259, CustomerID: 'ANATR', OrderDate: '1996-07-18', ShipCountry: 'Mexico'},
                            {OrderID: 10260, CustomerID: 'BERGS', OrderDate: '1996-07-19', ShipCountry: 'Sweden'},
                            {OrderID: 10261, CustomerID: 'BSBEV', OrderDate: '1996-07-19', ShipCountry: 'UK'},
                            {OrderID: 10262, CustomerID: 'CACTU', OrderDate: '1996-07-22', ShipCountry: 'Argentina'},
                            {OrderID: 10263, CustomerID: 'CENTC', OrderDate: '1996-07-23', ShipCountry: 'Mexico'},
                            {OrderID: 10264, CustomerID: 'CHOPS', OrderDate: '1996-07-24', ShipCountry: 'Switzerland'},
                            {OrderID: 10265, CustomerID: 'BLONP', OrderDate: '1996-07-25', ShipCountry: 'France'}
                        ];

                        // Inserir dados nas tabelas
                        alasql('INSERT INTO customers VALUES ?', [customersData]);
                        alasql('INSERT INTO categories VALUES ?', [categoriesData]);
                        alasql('INSERT INTO products VALUES ?', [productsData]);
                        alasql('INSERT INTO orders VALUES ?', [ordersData]);

                        // Aguardar um pequeno delay para garantir que os dados foram inseridos
                        await new Promise(resolve => setTimeout(resolve, 200));

                        // Atualizar estatísticas
                        await this.updateStatistics();
                        
                        this.loading = false;
                        
                        // Mostrar mensagem de sucesso
                        console.log('✅ Database initialized successfully!');
                        
                    } catch (error) {
                        console.error('❌ Error initializing database:', error);
                        this.loading = false;
                        this.customError = `Erro ao inicializar banco: ${error.message}`;
                    }
                },

                async executeQuery(index) {
                    try {
                        const startTime = performance.now();
                        const result = alasql(this.predefinedQueries[index].sql);
                        const endTime = performance.now();
                        
                        this.predefinedQueries[index].result = Array.isArray(result) ? result : [result];
                        this.predefinedQueries[index].executionTime = Math.round(endTime - startTime);
                        
                        // Adicionar ao histórico
                        this.addToHistory(this.predefinedQueries[index].sql);
                        
                    } catch (error) {
                        console.error('Error in predefined query:', error);
                        this.predefinedQueries[index].result = [];
                        this.customError = `Erro na consulta: ${error.message}`;
                        setTimeout(() => { this.customError = ''; }, 5000);
                    }
                },

                async executeCustomQuery() {
                    this.customError = '';
                    this.customResult = [];
                    this.queryExecutionTime = null;
                    
                    if (!this.customQuery.trim()) {
                        this.customError = 'Por favor, digite uma consulta SQL.';
                        return;
                    }
                    
                    try {
                        const startTime = performance.now();
                        const result = alasql(this.customQuery);
                        const endTime = performance.now();
                        
                        this.queryExecutionTime = Math.round(endTime - startTime);
                        
                        // Verifica se é uma consulta de modificação de dados
                        const queryLower = this.customQuery.trim().toLowerCase();
                        if (
                            queryLower.startsWith('insert') ||
                            queryLower.startsWith('delete') ||
                            queryLower.startsWith('update') ||
                            queryLower.startsWith('create') ||
                            queryLower.startsWith('drop') ||
                            queryLower.startsWith('alter')
                        ) {
                            await this.updateStatistics(); // Atualiza os contadores
                            // Para comandos de modificação, mostrar resultado de confirmação
                            if (typeof result === 'number') {
                                this.customResult = [{
                                    'Tipo de Operação': queryLower.split(' ')[0].toUpperCase(),
                                    'Registros Afetados': result,
                                    'Status': 'Sucesso'
                                }];
                            } else {
                                this.customResult = Array.isArray(result) ? result : [result];
                            }
                        } else {
                            this.customResult = Array.isArray(result) ? result : [result];
                        }
                        
                        // Adicionar ao histórico
                        this.addToHistory(this.customQuery);
                        
                        // Limpar erro de execução anterior
                        setTimeout(() => { this.queryExecutionTime = null; }, 5000);
                        
                    } catch (error) {
                        this.customError = `Erro na consulta: ${error.message}`;
                        console.error('Custom query error:', error);
                    }
                },

                async updateStatistics() {
                    try {
                        // Consultar o banco para obter contadores reais
                        const customers = alasql('SELECT COUNT(1) as count FROM customers')[0];
                        const products = alasql('SELECT COUNT(1) as count FROM products')[0];
                        const orders = alasql('SELECT COUNT(1) as count FROM orders')[0];
                        const categories = alasql('SELECT COUNT(1) as count FROM categories')[0];
                        
                        this.customersCount = customers.count;
                        this.productsCount = products.count;
                        this.ordersCount = orders.count;
                        this.categoriesCount = categories.count;
                        
                        // Trigger animation
                        this.statisticsUpdated = true;
                        setTimeout(() => { this.statisticsUpdated = false; }, 2000);
                        
                        console.log('📊 Statistics updated:', {
                            customers: this.customersCount,
                            products: this.productsCount,
                            orders: this.ordersCount,
                            categories: this.categoriesCount
                        });
                    } catch (error) {
                        console.error('Error updating statistics:', error);
                        // Fallback para valores padrão em caso de erro
                        this.customersCount = 0;
                        this.productsCount = 0;
                        this.ordersCount = 0;
                        this.categoriesCount = 0;
                    }
                },

                setExampleQuery(query) {
                    this.customQuery = query;
                    this.customError = '';
                    this.customResult = [];
                },

                copyToCustomQuery(sql) {
                    this.customQuery = sql;
                    this.customError = '';
                    this.customResult = [];
                    
                    // Scroll to custom query section
                    document.querySelector('.custom-query-section').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                },

                clearQuery() {
                    this.customQuery = '';
                    this.customResult = [];
                    this.customError = '';
                    this.queryExecutionTime = null;
                },

                addToHistory(query) {
                    if (query && query.trim()) {
                        // Evitar duplicatas consecutivas
                        if (this.queryHistory[this.queryHistory.length - 1] !== query.trim()) {
                            this.queryHistory.push(query.trim());
                            // Manter apenas os últimos 10 queries
                            if (this.queryHistory.length > 10) {
                                this.queryHistory.shift();
                            }
                        }
                    }
                },

                formatValue(value) {
                    if (value === null || value === undefined) {
                        return 'NULL';
                    }
                    if (typeof value === 'number') {
                        // Formatar números com 2 casas decimais se for um preço
                        if (value % 1 !== 0) {
                            return value.toFixed(2);
                        }
                    }
                    if (typeof value === 'string' && value.length > 50) {
                        return value.substring(0, 50) + '...';
                    }
                    return value;
                }
            }
        }).mount('#app');
    </script>
</body>
</html>